""" Console Output
+--------+--------+---------+---------------+---------------+-----------------+
| cust   | prod   |   month |   1_sum_quant |   2_max_quant |   3_count_quant |
|--------+--------+---------+---------------+---------------+-----------------|
| Chae   | Ham    |       4 |          1676 |           363 |               2 |
| Mia    | Fish   |       9 |          1561 |           887 |               0 |
| Mia    | Dates  |       7 |          1005 |   -2147483648 |               1 |
| Sam    | Jelly  |       7 |          2020 |           633 |               3 |
| Chae   | Eggs   |       2 |            97 |   -2147483648 |               3 |
| Wally  | Cherry |       5 |          2568 |           831 |               1 |
| Dan    | Dates  |       5 |          1396 |           971 |               4 |
| Chae   | Dates  |       6 |          1582 |           584 |               3 |
| Dan    | Grapes |       9 |          3110 |   -2147483648 |               4 |
| Wally  | Ham    |      10 |          2269 |   -2147483648 |               1 |
| Helen  | Ham    |      11 |          1177 |   -2147483648 |               5 |
| Helen  | Cherry |       6 |          1973 |           490 |               1 |
| Dan    | Fish   |      12 |          2123 |           184 |               1 |
| Sam    | Ham    |       3 |          1877 |           907 |               4 |
| Claire | Jelly  |      11 |           659 |           990 |               4 |
| Helen  | Ice    |      11 |          4591 |           887 |               2 |
| Dan    | Eggs   |       8 |           706 |           914 |               2 |
| Dan    | Apple  |       3 |           911 |           561 |               4 |
| Claire | Jelly  |      10 |           677 |           930 |               3 |
| Claire | Jelly  |      12 |          1366 |           722 |               6 |
| Dan    | Jelly  |       1 |           713 |           506 |               3 |
| Helen  | Cherry |       1 |          2702 |           996 |               5 |
| Mia    | Jelly  |       5 |          2834 |           581 |               2 |
| Sam    | Ham    |      12 |          2546 |           198 |               2 |
| Claire | Cherry |       8 |          1509 |           677 |               3 |
| Chae   | Butter |      10 |           954 |           709 |               3 |
| Helen  | Ham    |       3 |          1382 |           720 |               3 |
| Chae   | Ice    |       5 |           913 |           845 |               1 |
| Sam    | Cherry |       8 |          1667 |   -2147483648 |               5 |
| Mia    | Jelly  |       7 |          3050 |           802 |               2 |
| Chae   | Grapes |       9 |          1642 |           788 |               2 |
| Helen  | Ice    |       9 |          2469 |           970 |               4 |
| Chae   | Ice    |      11 |          1691 |           816 |               2 |
| Boo    | Apple  |       1 |           651 |           759 |               1 |
| Emily  | Ice    |       1 |          1711 |           811 |               1 |
| Claire | Cherry |       3 |           819 |           378 |               3 |
| Sam    | Dates  |      11 |          1291 |           959 |               2 |
| Chae   | Grapes |       4 |          1050 |           421 |               4 |
| Mia    | Butter |       4 |          1772 |   -2147483648 |               5 |
| Emily  | Cherry |       7 |          1384 |   -2147483648 |               1 |
| Wally  | Dates  |       3 |           817 |           643 |               3 |
| Mia    | Cherry |       1 |          1885 |           813 |               2 |
| Claire | Cherry |       4 |          1937 |           203 |               2 |
| Sam    | Ice    |       5 |          1399 |           382 |               4 |
| Chae   | Apple  |       5 |           690 |   -2147483648 |               1 |
| Wally  | Apple  |       4 |           957 |   -2147483648 |               3 |
| Mia    | Butter |      11 |          1394 |           947 |               0 |
| Wally  | Cherry |       7 |          1417 |           704 |               4 |
| Emily  | Cherry |       2 |          1575 |           633 |               1 |
| Emily  | Apple  |      10 |          1884 |           714 |               7 |
| Chae   | Butter |       1 |           996 |           251 |               4 |
| Boo    | Grapes |       2 |           963 |           229 |               2 |
| Claire | Apple  |       4 |          2107 |           776 |               1 |
| Sam    | Cherry |       2 |          1710 |           456 |               0 |
| Wally  | Ice    |       7 |           877 |           419 |               2 |
| Wally  | Ham    |       6 |           950 |           108 |               0 |
| Sam    | Apple  |       9 |           195 |           916 |               1 |
| Dan    | Eggs   |       7 |           214 |           890 |               1 |
| Wally  | Apple  |       8 |          2167 |           945 |               4 |
| Wally  | Ham    |      11 |          2340 |           262 |               1 |
| Mia    | Cherry |       5 |           846 |           990 |               0 |
| Dan    | Cherry |       6 |          1793 |   -2147483648 |               4 |
| Sam    | Jelly  |       5 |          2105 |           267 |               5 |
| Boo    | Apple  |       8 |           805 |           574 |               1 |
| Claire | Jelly  |       9 |          1682 |           777 |               0 |
| Sam    | Cherry |       6 |          1469 |   -2147483648 |               3 |
| Boo    | Cherry |       9 |           571 |   -2147483648 |               3 |
| Emily  | Dates  |       8 |           842 |           870 |               2 |
| Claire | Dates  |       2 |           737 |           831 |               3 |
| Helen  | Eggs   |      11 |           915 |           933 |               1 |
| Dan    | Ice    |      12 |          1416 |           891 |               0 |
| Helen  | Butter |      10 |          1660 |           871 |               2 |
| Chae   | Butter |       3 |           525 |           519 |               2 |
| Dan    | Ham    |       8 |          1498 |           799 |               3 |
| Claire | Dates  |       3 |          3655 |           281 |               0 |
| Wally  | Fish   |       3 |          2270 |           648 |               4 |
| Mia    | Butter |       7 |          2940 |           890 |               0 |
| Dan    | Butter |       6 |          2096 |           862 |               2 |
| Mia    | Dates  |       5 |           844 |           510 |               2 |
| Boo    | Dates  |       9 |           513 |           802 |               1 |
| Dan    | Fish   |      10 |          2233 |   -2147483648 |               3 |
| Wally  | Ham    |       1 |          1642 |           719 |               2 |
| Dan    | Butter |       8 |          2058 |           958 |               2 |
| Helen  | Jelly  |       1 |          2858 |           654 |               4 |
| Mia    | Ice    |       9 |          2749 |           684 |               4 |
| Sam    | Jelly  |       8 |          2911 |           970 |               2 |
| Wally  | Grapes |       3 |          1731 |           984 |               4 |
| Boo    | Eggs   |      11 |          1444 |           410 |               0 |
| Emily  | Ham    |      10 |          1525 |           694 |               3 |
| Chae   | Fish   |       7 |          2184 |           781 |               0 |
| Claire | Butter |       3 |          4647 |           826 |               3 |
| Wally  | Jelly  |       3 |          1000 |           695 |               0 |
| Sam    | Dates  |       4 |          1680 |           726 |               0 |
| Boo    | Apple  |       4 |          3903 |           979 |               4 |
| Wally  | Eggs   |       9 |          2281 |           705 |               3 |
| Wally  | Ham    |       5 |          2832 |           628 |               5 |
| Dan    | Grapes |       6 |           940 |           286 |               1 |
| Helen  | Dates  |       8 |          1028 |   -2147483648 |               0 |
| Wally  | Ice    |       5 |          2006 |           790 |               3 |
| Claire | Dates  |      12 |          1720 |           571 |               0 |
| Wally  | Eggs   |       5 |          2576 |           985 |               4 |
| Emily  | Eggs   |       1 |          1198 |   -2147483648 |               2 |
| Emily  | Eggs   |      10 |          1480 |   -2147483648 |               3 |
| Helen  | Eggs   |      12 |          1087 |   -2147483648 |               2 |
| Emily  | Fish   |       5 |          1734 |   -2147483648 |               2 |
| Chae   | Butter |       5 |          1476 |           565 |               3 |
| Boo    | Jelly  |      12 |          1073 |           896 |               1 |
| Sam    | Cherry |       3 |          1672 |           858 |               1 |
| Mia    | Ham    |       6 |          1796 |           410 |               1 |
| Chae   | Apple  |       6 |          1476 |           533 |               1 |
| Boo    | Ice    |       9 |           964 |           950 |               1 |
| Boo    | Apple  |      12 |          2297 |   -2147483648 |               3 |
| Boo    | Jelly  |       2 |          2667 |           514 |               2 |
| Dan    | Ham    |       2 |           832 |           709 |               0 |
| Mia    | Jelly  |      12 |          1401 |   -2147483648 |               1 |
| Claire | Grapes |       3 |          2638 |           871 |               4 |
| Wally  | Jelly  |       2 |           518 |   -2147483648 |               0 |
| Wally  | Apple  |       9 |          1619 |   -2147483648 |               5 |
| Chae   | Dates  |       3 |           991 |           231 |               4 |
| Mia    | Grapes |      11 |          2314 |           621 |               1 |
| Helen  | Ice    |       2 |           128 |   -2147483648 |               2 |
| Claire | Butter |       9 |          2154 |           478 |               2 |
| Chae   | Eggs   |       1 |          2620 |   -2147483648 |               2 |
| Chae   | Dates  |      10 |          1722 |           829 |               0 |
| Wally  | Cherry |       1 |          1037 |           857 |               0 |
| Sam    | Jelly  |      11 |          1360 |           949 |               1 |
| Helen  | Jelly  |       5 |          1328 |           768 |               3 |
| Emily  | Jelly  |      11 |           845 |           712 |               2 |
| Sam    | Dates  |      12 |          2296 |           543 |               3 |
| Dan    | Ice    |       8 |          2351 |           659 |               0 |
| Claire | Butter |       2 |          2596 |           746 |               5 |
| Claire | Fish   |       7 |          1029 |           582 |               1 |
| Claire | Butter |       5 |          1531 |           883 |               1 |
| Wally  | Butter |       7 |          1856 |           847 |               5 |
| Sam    | Ice    |      12 |          2557 |           712 |               0 |
| Dan    | Eggs   |       9 |           975 |           925 |               4 |
| Wally  | Butter |       9 |           753 |            99 |               2 |
| Chae   | Fish   |       8 |          3792 |           455 |               2 |
| Mia    | Eggs   |       4 |          4215 |           599 |               2 |
| Chae   | Eggs   |      10 |          2953 |           831 |               5 |
| Dan    | Ham    |       9 |           832 |           194 |               4 |
| Mia    | Apple  |       3 |           626 |   -2147483648 |               4 |
| Mia    | Grapes |       3 |          1241 |           658 |               3 |
| Chae   | Cherry |       1 |          1544 |   -2147483648 |               3 |
| Helen  | Butter |       8 |          4309 |           614 |               3 |
| Dan    | Jelly  |       6 |          2172 |           422 |               1 |
| Claire | Ham    |       5 |          2503 |           335 |               0 |
| Mia    | Fish   |      12 |           653 |   -2147483648 |               3 |
| Chae   | Fish   |       9 |          2073 |           638 |               1 |
| Emily  | Grapes |       2 |          1307 |           928 |               1 |
| Boo    | Butter |       2 |          2867 |           608 |               2 |
| Boo    | Cherry |       3 |          1463 |           816 |               3 |
| Sam    | Fish   |      11 |          1573 |           836 |               0 |
| Claire | Fish   |      10 |          1061 |           913 |               3 |
| Wally  | Eggs   |       8 |          1622 |           364 |               2 |
| Mia    | Jelly  |       1 |          2477 |           563 |               5 |
| Claire | Fish   |       5 |          2299 |           923 |               0 |
| Dan    | Dates  |       9 |           907 |           618 |               6 |
| Chae   | Ham    |       9 |          1533 |           211 |               3 |
| Helen  | Eggs   |      10 |          1831 |           527 |               1 |
| Dan    | Cherry |       3 |           789 |           141 |               4 |
| Helen  | Cherry |       7 |           808 |           988 |               5 |
| Boo    | Dates  |       6 |          1181 |           631 |               1 |
| Emily  | Butter |       1 |          2357 |           682 |               1 |
| Helen  | Jelly  |       8 |           977 |           616 |               3 |
| Helen  | Ice    |      10 |          3566 |           892 |               5 |
| Helen  | Jelly  |      12 |          1360 |   -2147483648 |               1 |
| Boo    | Butter |      11 |          2394 |           959 |               1 |
| Wally  | Eggs   |      12 |          1075 |           900 |               4 |
| Sam    | Apple  |      12 |          1324 |           951 |               3 |
| Helen  | Fish   |       6 |          1691 |   -2147483648 |               6 |
| Sam    | Eggs   |       4 |          1472 |           655 |               1 |
| Chae   | Apple  |      11 |          2902 |           777 |               3 |
| Emily  | Grapes |       3 |           842 |           502 |               4 |
| Chae   | Ice    |       8 |          1061 |           786 |               4 |
| Wally  | Ham    |       7 |           892 |           698 |               1 |
| Chae   | Butter |       7 |          1130 |           943 |               2 |
| Chae   | Eggs   |       7 |          1458 |            58 |               0 |
| Chae   | Jelly  |       3 |           641 |   -2147483648 |               1 |
| Claire | Eggs   |       2 |           958 |           436 |               2 |
| Sam    | Jelly  |       2 |          3121 |           507 |               3 |
| Boo    | Grapes |       9 |           939 |           587 |               2 |
| Helen  | Cherry |       9 |           878 |           894 |               1 |
| Mia    | Fish   |       3 |          2140 |           480 |               0 |
| Dan    | Apple  |       9 |          2087 |           907 |               1 |
| Mia    | Butter |       1 |          1749 |           340 |               1 |
| Wally  | Jelly  |       4 |          1493 |           214 |               4 |
| Dan    | Ham    |       7 |          1733 |           843 |               3 |
| Chae   | Ham    |      11 |          1325 |           500 |               1 |
| Emily  | Butter |       5 |          1996 |           259 |               2 |
| Helen  | Fish   |      11 |          1842 |           699 |               0 |
| Chae   | Dates  |      12 |          2556 |           862 |               2 |
| Claire | Grapes |       5 |           434 |           738 |               0 |
| Chae   | Eggs   |       5 |          1041 |           343 |               0 |
| Helen  | Butter |       4 |           875 |           668 |               4 |
| Chae   | Apple  |       8 |          2708 |           466 |               3 |
| Mia    | Eggs   |       9 |          1085 |           883 |               1 |
| Dan    | Grapes |       8 |          3138 |           834 |               0 |
| Helen  | Eggs   |       8 |           845 |           773 |               3 |
| Boo    | Cherry |      10 |          2101 |           585 |               0 |
| Boo    | Butter |       1 |          1221 |           666 |               4 |
| Helen  | Butter |       6 |          1870 |           992 |               2 |
| Helen  | Jelly  |      11 |           397 |           825 |               1 |
| Boo    | Grapes |       1 |          2928 |   -2147483648 |               2 |
| Boo    | Eggs   |       7 |          2440 |           459 |               5 |
| Mia    | Ham    |       3 |          1568 |           908 |               1 |
| Mia    | Ham    |       8 |           983 |           902 |               2 |
| Wally  | Butter |       6 |          1727 |           399 |               0 |
| Claire | Ice    |      12 |          3101 |           482 |               3 |
| Chae   | Dates  |       4 |          2489 |   -2147483648 |               2 |
| Helen  | Ice    |       1 |          2111 |           768 |               1 |
| Mia    | Eggs   |       8 |          3943 |           877 |               0 |
| Dan    | Grapes |       5 |          2218 |           475 |               1 |
| Boo    | Cherry |       1 |          2055 |           908 |               1 |
| Wally  | Ice    |      12 |           591 |           131 |               4 |
| Sam    | Butter |      10 |          1119 |           854 |               0 |
| Helen  | Grapes |      11 |          2593 |           726 |               1 |
| Chae   | Grapes |       8 |          1645 |           513 |               5 |
| Helen  | Cherry |      11 |          2097 |           881 |               1 |
| Claire | Dates  |       4 |          2674 |           681 |               2 |
| Wally  | Grapes |      10 |          1050 |           286 |               4 |
| Dan    | Dates  |       6 |          2752 |           989 |               2 |
| Emily  | Cherry |      12 |           883 |           964 |               4 |
| Sam    | Ice    |      10 |          1232 |   -2147483648 |               1 |
| Dan    | Grapes |       2 |          1882 |           870 |               1 |
| Dan    | Ice    |       3 |           886 |           743 |               1 |
| Boo    | Ice    |      12 |           370 |   -2147483648 |               0 |
| Sam    | Fish   |       9 |          2397 |           409 |               4 |
| Dan    | Eggs   |       1 |          2322 |   -2147483648 |               5 |
| Sam    | Eggs   |       5 |          2278 |           746 |               2 |
| Chae   | Fish   |       2 |           312 |           838 |               3 |
| Sam    | Grapes |       2 |           545 |           802 |               1 |
| Chae   | Grapes |       1 |           914 |           844 |               1 |
| Emily  | Dates  |       9 |           700 |           771 |               0 |
| Sam    | Grapes |      11 |          1998 |           697 |               0 |
| Sam    | Ice    |      11 |          1851 |           649 |               4 |
| Boo    | Ice    |       2 |           855 |           776 |               1 |
| Dan    | Ice    |       6 |          1185 |            79 |               4 |
| Emily  | Butter |       9 |           692 |           641 |               0 |
| Boo    | Cherry |       6 |           276 |   -2147483648 |               2 |
| Claire | Eggs   |       1 |          1675 |           590 |               2 |
| Emily  | Dates  |      11 |          2777 |           850 |               4 |
| Chae   | Jelly  |       1 |          2332 |   -2147483648 |               1 |
| Emily  | Ham    |       1 |           253 |           936 |               1 |
| Dan    | Dates  |      10 |          2157 |           860 |               3 |
| Wally  | Eggs   |       1 |           716 |           978 |               2 |
| Boo    | Jelly  |       9 |           864 |           418 |               6 |
| Chae   | Cherry |       4 |          2646 |           309 |               1 |
| Sam    | Ham    |      11 |          2547 |           452 |               4 |
| Dan    | Jelly  |       8 |          1750 |           591 |               2 |
| Sam    | Ice    |       4 |          2410 |           865 |               1 |
| Boo    | Dates  |       2 |          2686 |           983 |               4 |
| Chae   | Ice    |       6 |           367 |           595 |               1 |
| Mia    | Eggs   |       7 |           779 |           696 |               3 |
| Emily  | Ham    |       5 |          1660 |           390 |               6 |
| Emily  | Jelly  |       4 |          1212 |           994 |               3 |
| Emily  | Eggs   |       8 |          1707 |   -2147483648 |               3 |
| Helen  | Grapes |       6 |           624 |           890 |               0 |
| Dan    | Apple  |       8 |          2821 |   -2147483648 |               2 |
| Dan    | Fish   |       4 |          1512 |           426 |               6 |
| Boo    | Eggs   |       8 |           803 |           410 |               3 |
| Emily  | Grapes |       7 |           417 |           922 |               0 |
| Helen  | Dates  |       4 |          1903 |           661 |               2 |
| Helen  | Dates  |       6 |           289 |           620 |               1 |
| Helen  | Butter |       9 |          1739 |           480 |               0 |
| Mia    | Jelly  |       3 |           998 |           850 |               4 |
| Sam    | Ice    |       2 |           854 |           928 |               0 |
| Dan    | Jelly  |      10 |          2311 |           639 |               2 |
| Helen  | Dates  |      12 |          1118 |           600 |               0 |
| Helen  | Fish   |      12 |          1049 |           902 |               0 |
| Claire | Grapes |      12 |          2537 |           471 |               1 |
| Helen  | Ham    |      10 |           681 |            19 |               4 |
| Wally  | Ice    |       9 |          1204 |   -2147483648 |               3 |
| Emily  | Jelly  |       1 |          1395 |   -2147483648 |               2 |
| Wally  | Grapes |       8 |           620 |   -2147483648 |               3 |
| Emily  | Ham    |       9 |          1070 |           427 |               1 |
| Boo    | Eggs   |       4 |          1723 |           450 |               1 |
| Dan    | Butter |       5 |           814 |           757 |               3 |
| Helen  | Jelly  |       6 |          1647 |           942 |               0 |
| Claire | Apple  |       7 |           604 |           874 |               4 |
| Dan    | Fish   |       5 |          1922 |           676 |               3 |
| Mia    | Apple  |       2 |          1848 |           541 |               4 |
| Claire | Grapes |       8 |           713 |           766 |               3 |
| Emily  | Ham    |      12 |           723 |           416 |               2 |
| Sam    | Butter |       1 |           449 |   -2147483648 |               6 |
| Mia    | Ham    |      10 |          2148 |           184 |               4 |
| Helen  | Fish   |       8 |           928 |           999 |               3 |
| Chae   | Cherry |       3 |          1917 |           510 |               4 |
| Helen  | Dates  |       3 |           210 |   -2147483648 |               4 |
| Emily  | Dates  |       6 |          2967 |           901 |               1 |
| Boo    | Ham    |       3 |          1914 |           700 |               2 |
| Dan    | Eggs   |       3 |          1505 |           564 |               4 |
| Dan    | Grapes |      12 |           254 |           225 |               3 |
| Chae   | Fish   |      12 |           800 |   -2147483648 |               2 |
| Chae   | Ham    |       1 |          1224 |           455 |               2 |
| Claire | Fish   |       1 |          2457 |           639 |               2 |
| Helen  | Apple  |      11 |           770 |           741 |               1 |
| Boo    | Butter |       6 |          2327 |   -2147483648 |               4 |
| Boo    | Grapes |      12 |           655 |           861 |               3 |
| Mia    | Ham    |       9 |           269 |           908 |               0 |
| Dan    | Ice    |       2 |           590 |           877 |               2 |
| Dan    | Eggs   |       4 |          2237 |           876 |               1 |
| Emily  | Butter |       3 |          2068 |           560 |               1 |
| Boo    | Dates  |      10 |           537 |           580 |               1 |
| Dan    | Cherry |       2 |           507 |           626 |               0 |
| Mia    | Ice    |       5 |          1639 |           813 |               1 |
| Claire | Ice    |       9 |           995 |           763 |               2 |
| Claire | Eggs   |       6 |           887 |           597 |               1 |
| Chae   | Eggs   |       6 |          1793 |           307 |               2 |
| Chae   | Ice    |       2 |           702 |   -2147483648 |               5 |
| Mia    | Dates  |      12 |          1614 |           222 |               4 |
| Helen  | Fish   |       5 |           919 |   -2147483648 |               4 |
| Emily  | Ice    |       2 |          1549 |           525 |               0 |
| Emily  | Jelly  |       2 |           126 |           953 |               0 |
| Claire | Butter |       4 |          1720 |           853 |               3 |
| Sam    | Cherry |       7 |          1995 |           949 |               1 |
| Sam    | Fish   |       4 |          3813 |           875 |               1 |
| Sam    | Ham    |       2 |           431 |           969 |               2 |
| Chae   | Fish   |       3 |          1349 |           874 |               3 |
| Emily  | Apple  |       1 |          1429 |           126 |               2 |
| Emily  | Grapes |       1 |          1770 |           707 |               3 |
| Claire | Eggs   |       3 |          2209 |   -2147483648 |               3 |
| Claire | Ice    |       3 |          2691 |   -2147483648 |               1 |
| Mia    | Ham    |       1 |          1448 |           645 |               2 |
| Chae   | Cherry |      11 |          1273 |           831 |               0 |
| Claire | Ham    |      12 |           733 |           485 |               4 |
| Emily  | Ice    |       7 |           370 |           570 |               1 |
| Sam    | Butter |       8 |          2264 |   -2147483648 |               2 |
| Boo    | Dates  |      11 |          1275 |           208 |               4 |
| Emily  | Ham    |       8 |          1201 |           975 |               2 |
| Chae   | Cherry |       6 |          3846 |           353 |               4 |
| Emily  | Fish   |       9 |           534 |   -2147483648 |               2 |
| Helen  | Cherry |       2 |          1832 |           998 |               1 |
| Sam    | Fish   |       5 |          1112 |           890 |               6 |
| Helen  | Ice    |       5 |          2744 |           927 |               2 |
| Helen  | Dates  |       5 |          2335 |           814 |               1 |
| Dan    | Ham    |      10 |          2099 |           431 |               2 |
| Wally  | Fish   |       1 |          1196 |           739 |               3 |
| Dan    | Grapes |      10 |           731 |           679 |               1 |
| Helen  | Apple  |       3 |           847 |           840 |               1 |
| Emily  | Apple  |       3 |          1681 |   -2147483648 |               4 |
| Dan    | Dates  |       4 |           449 |           686 |               1 |
| Wally  | Cherry |       2 |          1981 |           775 |               2 |
| Dan    | Apple  |       1 |          1418 |          1000 |               3 |
| Dan    | Apple  |       7 |          1599 |           565 |               2 |
| Mia    | Jelly  |       4 |          2205 |           847 |               0 |
| Boo    | Ham    |       7 |           855 |           853 |               4 |
| Sam    | Ham    |      10 |          1691 |           954 |               3 |
| Emily  | Fish   |      11 |          1117 |           763 |               2 |
| Claire | Cherry |      11 |          1757 |           997 |               3 |
| Claire | Butter |       6 |           426 |   -2147483648 |               1 |
| Wally  | Jelly  |       7 |          2011 |           947 |               0 |
| Sam    | Fish   |       2 |           508 |           485 |               3 |
| Helen  | Grapes |       8 |           954 |           311 |               3 |
| Claire | Butter |      12 |          1911 |           585 |               4 |
| Chae   | Ice    |       4 |          2662 |           788 |               4 |
| Helen  | Ice    |      12 |           931 |           982 |               3 |
| Helen  | Apple  |       7 |          1436 |           820 |               1 |
| Sam    | Grapes |       1 |          1614 |             5 |               2 |
| Helen  | Grapes |       4 |          1233 |           626 |               0 |
| Boo    | Butter |       7 |          1253 |           756 |               4 |
| Helen  | Jelly  |       9 |          2345 |           850 |               2 |
| Boo    | Butter |       3 |          1519 |           986 |               0 |
| Claire | Ham    |       8 |          1034 |           623 |               0 |
| Emily  | Fish   |      12 |          2428 |           987 |               0 |
| Boo    | Grapes |       3 |           317 |            47 |               3 |
| Mia    | Eggs   |      11 |          2180 |   -2147483648 |               1 |
| Mia    | Ice    |      11 |           987 |           978 |               3 |
| Helen  | Ham    |       9 |          1763 |           924 |               2 |
| Sam    | Eggs   |       8 |          2503 |           359 |               2 |
| Claire | Fish   |      12 |           433 |   -2147483648 |               0 |
| Wally  | Ham    |       3 |          2445 |            27 |               1 |
| Boo    | Eggs   |       3 |          1864 |           947 |               6 |
| Boo    | Dates  |       1 |           927 |   -2147483648 |               0 |
| Mia    | Butter |      10 |          1677 |           879 |               2 |
| Helen  | Eggs   |       2 |          2021 |           879 |               2 |
| Wally  | Cherry |       6 |          2286 |           525 |               5 |
| Mia    | Butter |       6 |          2005 |           917 |               2 |
| Sam    | Ice    |       7 |          1001 |           756 |               0 |
| Boo    | Cherry |      11 |          2887 |   -2147483648 |               0 |
| Emily  | Fish   |      10 |          3620 |           623 |               1 |
| Mia    | Ham    |       2 |          1229 |           882 |               3 |
| Helen  | Ham    |       4 |          2370 |           683 |               2 |
| Dan    | Jelly  |       2 |           685 |   -2147483648 |               1 |
| Chae   | Cherry |       9 |           813 |   -2147483648 |               5 |
| Mia    | Grapes |       5 |          1751 |           209 |               2 |
| Emily  | Butter |      11 |          1814 |           487 |               4 |
| Emily  | Grapes |      11 |          1972 |   -2147483648 |               1 |
| Mia    | Apple  |      12 |          2586 |           463 |               0 |
| Claire | Eggs   |      12 |          1490 |            91 |               1 |
| Wally  | Dates  |       8 |          1248 |   -2147483648 |               1 |
| Sam    | Fish   |       3 |           154 |           221 |               0 |
| Emily  | Eggs   |       7 |          2392 |           410 |               2 |
| Boo    | Ham    |       2 |           992 |           290 |               1 |
| Chae   | Dates  |       5 |          1744 |           694 |               2 |
| Emily  | Grapes |       5 |          1866 |           894 |               0 |
| Emily  | Cherry |       6 |          1081 |           572 |               1 |
| Mia    | Butter |       2 |          1095 |           920 |               4 |
| Helen  | Cherry |       3 |          1771 |           761 |               3 |
| Emily  | Apple  |       2 |          3896 |           508 |               2 |
| Wally  | Apple  |       6 |          1587 |           173 |               3 |
| Dan    | Cherry |       9 |          1838 |           939 |               1 |
| Sam    | Fish   |       1 |          1830 |           824 |               4 |
| Mia    | Ham    |       5 |          1187 |           919 |               1 |
| Mia    | Ham    |       4 |          1530 |           814 |               2 |
| Emily  | Cherry |      10 |          4248 |           917 |               1 |
| Claire | Jelly  |       1 |          2308 |           221 |               1 |
| Boo    | Grapes |       7 |          1840 |           593 |               5 |
| Emily  | Jelly  |      12 |          1519 |           359 |               4 |
| Wally  | Jelly  |       1 |           593 |           130 |               3 |
| Helen  | Jelly  |       4 |          1892 |   -2147483648 |               3 |
| Emily  | Ice    |      11 |           968 |           950 |               2 |
| Boo    | Fish   |      11 |          1366 |           899 |               1 |
| Mia    | Grapes |       2 |           352 |   -2147483648 |               4 |
| Wally  | Butter |       5 |           550 |           986 |               2 |
| Mia    | Dates  |      10 |          1442 |   -2147483648 |               1 |
| Boo    | Cherry |      12 |          1109 |           968 |               1 |
| Boo    | Jelly  |       8 |          2796 |   -2147483648 |               2 |
| Wally  | Ham    |       4 |          2171 |           623 |               3 |
| Wally  | Ice    |       3 |          1543 |   -2147483648 |               4 |
| Sam    | Dates  |      10 |          1129 |           997 |               1 |
| Claire | Apple  |      12 |          1366 |   -2147483648 |               3 |
| Claire | Ham    |       1 |          1877 |   -2147483648 |               4 |
| Chae   | Dates  |      11 |           715 |           345 |               2 |
| Helen  | Ham    |       7 |          1022 |   -2147483648 |               4 |
| Sam    | Dates  |       3 |           625 |           926 |               3 |
| Boo    | Cherry |       4 |          1215 |             9 |               3 |
| Sam    | Jelly  |       4 |          1446 |           794 |               0 |
| Dan    | Ice    |      10 |          1338 |           441 |               2 |
| Mia    | Apple  |       8 |          2220 |           785 |               3 |
| Wally  | Grapes |      11 |          1604 |   -2147483648 |               2 |
| Emily  | Grapes |       9 |           614 |           911 |               1 |
| Chae   | Apple  |       7 |          1352 |           893 |               2 |
| Sam    | Eggs   |       1 |          2303 |           455 |               1 |
| Wally  | Jelly  |       9 |           734 |           685 |               1 |
| Chae   | Grapes |      11 |          1215 |   -2147483648 |               1 |
| Sam    | Ham    |       5 |           914 |           914 |               3 |
| Emily  | Butter |       4 |          1722 |           130 |               1 |
| Helen  | Eggs   |       3 |          1598 |   -2147483648 |               5 |
| Wally  | Dates  |       9 |           844 |           643 |               1 |
| Claire | Fish   |       6 |           777 |   -2147483648 |               3 |
| Wally  | Grapes |      12 |          1231 |   -2147483648 |               2 |
| Helen  | Fish   |       3 |           956 |           924 |               0 |
| Dan    | Cherry |       4 |           596 |   -2147483648 |               1 |
| Mia    | Eggs   |       3 |          2333 |           767 |               2 |
| Sam    | Jelly  |       9 |          1908 |           908 |               0 |
| Emily  | Jelly  |       7 |           564 |           572 |               3 |
| Mia    | Butter |       8 |           974 |           501 |               3 |
| Emily  | Eggs   |       4 |           349 |           977 |               0 |
| Mia    | Eggs   |       2 |           508 |           848 |               3 |
| Mia    | Butter |      12 |          2558 |           390 |               2 |
| Wally  | Apple  |      11 |          1206 |   -2147483648 |               4 |
| Claire | Cherry |       2 |           754 |           245 |               1 |
| Emily  | Dates  |      10 |          1145 |           901 |               1 |
| Claire | Ice    |       5 |          2074 |           961 |               2 |
| Helen  | Butter |      12 |           542 |           610 |               2 |
| Sam    | Grapes |       8 |           863 |   -2147483648 |               2 |
| Claire | Jelly  |       2 |           978 |           268 |               0 |
| Claire | Jelly  |       5 |           913 |           994 |               0 |
| Boo    | Ham    |       9 |           957 |           839 |               1 |
| Claire | Butter |       8 |          2810 |           696 |               2 |
| Claire | Apple  |       1 |          1940 |           642 |               1 |
| Dan    | Butter |       9 |          1764 |           837 |               1 |
| Mia    | Cherry |       7 |          2062 |           239 |               1 |
| Helen  | Apple  |       1 |          2221 |           893 |               1 |
| Wally  | Apple  |       7 |           525 |   -2147483648 |               4 |
| Claire | Eggs   |       4 |           600 |           338 |               1 |
| Wally  | Apple  |       1 |          1859 |           860 |               2 |
| Wally  | Fish   |       6 |           178 |           695 |               0 |
| Helen  | Ham    |       6 |           105 |           915 |               0 |
| Boo    | Ice    |      10 |          1701 |           387 |               2 |
| Mia    | Grapes |       6 |          1603 |           597 |               2 |
| Chae   | Fish   |       6 |          1755 |           777 |               4 |
| Dan    | Cherry |      12 |           658 |           320 |               3 |
| Claire | Fish   |       8 |          2165 |            53 |               4 |
| Dan    | Jelly  |       7 |          2185 |           699 |               1 |
| Emily  | Grapes |      10 |          1676 |           625 |               1 |
| Dan    | Dates  |       7 |          1118 |           711 |               5 |
| Boo    | Butter |      10 |          1171 |           395 |               3 |
| Chae   | Cherry |       8 |          2226 |           605 |               2 |
| Sam    | Apple  |       1 |          1817 |   -2147483648 |               3 |
| Mia    | Fish   |       2 |          1767 |           740 |               2 |
| Boo    | Ice    |       8 |          1215 |            88 |               3 |
| Wally  | Jelly  |       8 |           780 |           841 |               1 |
| Claire | Ham    |       2 |           426 |           922 |               1 |
| Wally  | Apple  |      10 |          1172 |           759 |               3 |
| Helen  | Ham    |       5 |          2385 |           739 |               3 |
| Chae   | Jelly  |       6 |          2009 |   -2147483648 |               1 |
| Sam    | Eggs   |       6 |          1542 |           289 |               1 |
| Boo    | Butter |       8 |           561 |   -2147483648 |               2 |
| Sam    | Butter |       7 |          3220 |           996 |               1 |
| Chae   | Ice    |      10 |           633 |           293 |               1 |
| Mia    | Ice    |       8 |          1083 |           519 |               5 |
| Claire | Grapes |       9 |           819 |           555 |               2 |
| Claire | Apple  |       6 |          1225 |           356 |               1 |
| Boo    | Butter |       5 |          1490 |   -2147483648 |               4 |
| Helen  | Apple  |      10 |          2424 |           272 |               2 |
| Sam    | Grapes |       3 |           786 |           501 |               1 |
| Claire | Ham    |       7 |          1826 |   -2147483648 |               5 |
| Sam    | Apple  |      11 |          1235 |           983 |               3 |
| Chae   | Ham    |       8 |          2147 |           782 |               1 |
| Boo    | Ice    |       3 |           818 |   -2147483648 |               4 |
| Chae   | Apple  |       4 |          1113 |           658 |               3 |
| Chae   | Dates  |       8 |          1688 |           507 |               1 |
| Sam    | Grapes |       4 |          3208 |   -2147483648 |               1 |
| Chae   | Grapes |       7 |          1917 |           959 |               2 |
| Wally  | Eggs   |       4 |          2668 |           803 |               2 |
| Mia    | Cherry |      10 |           725 |           690 |               4 |
| Chae   | Jelly  |       2 |           295 |   -2147483648 |               2 |
| Sam    | Cherry |       9 |           224 |           916 |               0 |
| Chae   | Apple  |       9 |          1411 |           253 |               2 |
| Sam    | Cherry |       1 |           539 |   -2147483648 |               0 |
| Sam    | Fish   |      10 |          2360 |           945 |               2 |
| Claire | Butter |       1 |           845 |           546 |               3 |
| Mia    | Ice    |       6 |          1294 |           678 |               1 |
| Chae   | Dates  |       9 |          1220 |           270 |               2 |
| Chae   | Eggs   |      11 |          3628 |           134 |               1 |
| Helen  | Eggs   |       4 |          2949 |           946 |               2 |
| Helen  | Ice    |       4 |          2731 |            27 |               3 |
| Sam    | Dates  |       1 |          1551 |           825 |               0 |
| Claire | Cherry |       6 |          2212 |           748 |               2 |
| Sam    | Ice    |       9 |           731 |           864 |               3 |
| Claire | Apple  |       8 |          1749 |           947 |               1 |
| Sam    | Apple  |      10 |          1509 |           516 |               3 |
| Emily  | Ice    |       8 |          1882 |           871 |               0 |
| Chae   | Dates  |       7 |          1803 |           492 |               0 |
| Boo    | Grapes |      10 |          1453 |           283 |               3 |
| Sam    | Cherry |      10 |          1257 |           854 |               0 |
| Dan    | Eggs   |      11 |          1119 |           193 |               0 |
| Boo    | Fish   |       5 |          1519 |           107 |               2 |
| Dan    | Butter |       3 |          1001 |           932 |               2 |
| Emily  | Ice    |      12 |          1568 |           889 |               0 |
| Helen  | Fish   |       9 |          1439 |           978 |               1 |
| Sam    | Fish   |       8 |           282 |   -2147483648 |               2 |
| Claire | Ham    |       9 |          1247 |           687 |               3 |
| Sam    | Apple  |       6 |          1943 |          1000 |               3 |
| Boo    | Dates  |       7 |           662 |           776 |               3 |
| Dan    | Fish   |       3 |           947 |           987 |               1 |
| Boo    | Butter |       4 |          1364 |           653 |               3 |
| Dan    | Butter |       4 |          2213 |           916 |               6 |
| Dan    | Butter |      12 |           628 |           225 |               0 |
| Wally  | Fish   |       9 |          2277 |           188 |               2 |
| Chae   | Ham    |       5 |           992 |           997 |               0 |
| Chae   | Fish   |       1 |          1472 |           873 |               4 |
| Boo    | Fish   |       3 |          1592 |           349 |               1 |
| Sam    | Cherry |       4 |          2828 |           634 |               1 |
| Sam    | Butter |      11 |           943 |   -2147483648 |               3 |
| Boo    | Ice    |       6 |          2155 |           603 |               4 |
| Boo    | Ham    |      11 |          1412 |           973 |               0 |
| Emily  | Jelly  |      10 |            74 |   -2147483648 |               1 |
| Helen  | Butter |       5 |           137 |   -2147483648 |               7 |
| Dan    | Dates  |      12 |          1985 |           968 |               3 |
| Helen  | Grapes |       2 |           902 |   -2147483648 |               2 |
| Wally  | Cherry |      11 |           510 |   -2147483648 |               6 |
| Emily  | Apple  |       9 |          2107 |   -2147483648 |               2 |
| Emily  | Jelly  |       9 |           937 |           561 |               1 |
| Sam    | Butter |       9 |           844 |           354 |               3 |
| Emily  | Cherry |      11 |           679 |           594 |               1 |
| Claire | Jelly  |       3 |          1083 |           580 |               0 |
| Claire | Dates  |       6 |          1618 |           577 |               1 |
| Helen  | Ice    |       6 |          1311 |           808 |               2 |
| Chae   | Jelly  |      12 |          1774 |           747 |               3 |
| Dan    | Ice    |       1 |          1906 |           547 |               1 |
| Chae   | Grapes |       2 |          1706 |           536 |               3 |
| Chae   | Butter |       4 |           761 |           925 |               1 |
| Helen  | Butter |       2 |           279 |            42 |               1 |
| Chae   | Cherry |      12 |          1106 |            81 |               3 |
| Emily  | Dates  |       7 |          1876 |           743 |               4 |
| Chae   | Cherry |       5 |          2747 |           860 |               1 |
| Boo    | Grapes |       8 |           890 |           708 |               6 |
| Mia    | Apple  |       9 |           864 |           392 |               2 |
| Mia    | Grapes |      10 |           757 |           134 |               0 |
| Mia    | Cherry |       4 |          2293 |   -2147483648 |               1 |
| Wally  | Butter |       2 |          1658 |           576 |               2 |
| Boo    | Jelly  |       4 |          1507 |           945 |               2 |
| Wally  | Dates  |       4 |           837 |           771 |               1 |
| Dan    | Apple  |       6 |          1214 |           190 |               3 |
| Chae   | Ham    |      12 |          1626 |   -2147483648 |               3 |
| Claire | Jelly  |       8 |          1626 |           631 |               2 |
| Boo    | Jelly  |       5 |          1210 |           167 |               1 |
| Wally  | Ham    |       2 |          1389 |   -2147483648 |               1 |
| Mia    | Grapes |       8 |          1592 |           792 |               0 |
| Wally  | Apple  |       3 |          1902 |           837 |               4 |
| Mia    | Jelly  |       6 |          3879 |   -2147483648 |               2 |
| Emily  | Apple  |       4 |          1755 |           621 |               2 |
| Sam    | Butter |       3 |           752 |           872 |               3 |
| Mia    | Cherry |       6 |          1030 |           742 |               2 |
| Wally  | Eggs   |       2 |           929 |           218 |               1 |
| Chae   | Butter |       8 |          2741 |           991 |               4 |
| Mia    | Grapes |       7 |           416 |           669 |               0 |
| Emily  | Dates  |       4 |          1022 |           661 |               1 |
| Emily  | Dates  |       2 |           283 |   -2147483648 |               5 |
| Sam    | Dates  |       5 |          1742 |            35 |               4 |
| Claire | Grapes |       7 |           909 |   -2147483648 |               0 |
| Mia    | Cherry |       3 |           763 |           958 |               0 |
| Dan    | Eggs   |       5 |           663 |           900 |               1 |
| Boo    | Fish   |       2 |           488 |            85 |               3 |
| Wally  | Grapes |       9 |          1424 |           565 |               1 |
| Boo    | Fish   |       7 |          1164 |           355 |               0 |
| Mia    | Cherry |       2 |          1006 |           665 |               2 |
| Mia    | Grapes |      12 |          2162 |           271 |               2 |
| Chae   | Fish   |       4 |           643 |           761 |               2 |
| Emily  | Fish   |       7 |          1557 |           504 |               1 |
| Mia    | Butter |       9 |          1613 |           368 |               1 |
| Wally  | Apple  |      12 |           912 |           683 |               2 |
| Mia    | Ice    |       3 |          2871 |           486 |               3 |
| Boo    | Apple  |       5 |           606 |   -2147483648 |               0 |
| Emily  | Grapes |       8 |          1854 |           742 |               4 |
| Emily  | Ice    |       3 |           349 |   -2147483648 |               2 |
| Claire | Butter |      10 |           941 |           820 |               1 |
| Mia    | Ice    |      10 |           974 |           855 |               3 |
| Boo    | Apple  |      11 |           657 |           811 |               2 |
| Helen  | Butter |      11 |           810 |           164 |               1 |
| Dan    | Eggs   |       2 |          1870 |   -2147483648 |               2 |
| Wally  | Jelly  |       6 |           779 |           877 |               0 |
| Sam    | Butter |       5 |          3420 |           999 |               1 |
| Sam    | Dates  |       7 |           889 |           618 |               5 |
| Helen  | Cherry |      12 |           571 |   -2147483648 |               3 |
| Dan    | Grapes |       7 |          1431 |           466 |               0 |
| Dan    | Ham    |      12 |           644 |           644 |               3 |
| Emily  | Apple  |       8 |          1455 |           789 |               3 |
| Helen  | Eggs   |       7 |           849 |           770 |               0 |
| Sam    | Jelly  |       3 |           946 |           499 |               0 |
| Boo    | Butter |       9 |          2412 |           904 |               2 |
| Helen  | Apple  |      12 |           378 |           887 |               0 |
| Wally  | Grapes |       2 |           373 |            96 |               3 |
| Boo    | Fish   |       1 |           664 |           832 |               0 |
| Mia    | Dates  |       6 |           602 |           988 |               0 |
| Emily  | Grapes |       6 |           269 |           428 |               1 |
| Sam    | Apple  |       7 |          1499 |   -2147483648 |               1 |
| Claire | Dates  |      10 |          1051 |           846 |               0 |
| Sam    | Eggs   |      11 |          1882 |           811 |               2 |
| Sam    | Butter |       4 |           994 |   -2147483648 |               0 |
| Boo    | Butter |      12 |          1529 |           659 |               0 |
| Claire | Cherry |      12 |           653 |           780 |               2 |
| Dan    | Cherry |       5 |           728 |           895 |               0 |
| Mia    | Ice    |       1 |           258 |           737 |               0 |
| Helen  | Apple  |       4 |          1819 |           662 |               1 |
| Helen  | Grapes |       7 |          2134 |            12 |               1 |
| Dan    | Grapes |       1 |            68 |           362 |               0 |
| Wally  | Cherry |      10 |          1483 |           893 |               2 |
| Wally  | Grapes |       5 |          2277 |   -2147483648 |               0 |
| Dan    | Cherry |      10 |           361 |           532 |               0 |
| Sam    | Ham    |       6 |           442 |   -2147483648 |               3 |
| Mia    | Ham    |      11 |          1160 |   -2147483648 |               0 |
| Boo    | Cherry |       5 |          1027 |           607 |               0 |
| Claire | Eggs   |       7 |           665 |           714 |               0 |
| Claire | Cherry |      10 |           790 |   -2147483648 |               0 |
| Claire | Dates  |      11 |           309 |   -2147483648 |               0 |
| Emily  | Cherry |       8 |           923 |           750 |               0 |
+--------+--------+---------+---------------+---------------+-----------------+
"""

import os
import psycopg2
import psycopg2.extras
import tabulate
from dotenv import load_dotenv
from helper import inputHandler, createMFStructEntry, lookup
from collections import defaultdict
import re

# DO NOT EDIT THIS FILE, IT IS GENERATED BY generator.py

def query():
    load_dotenv()

    user = os.getenv('DB_USER')
    password = os.getenv('DB_PASSWORD')
    dbname = os.getenv('DB_NAME')

    conn = psycopg2.connect(
    dbname=dbname, user=user, password=password, host="localhost", port=5433, cursor_factory=psycopg2.extras.DictCursor)
    
    cur = conn.cursor()
    cur.execute("SELECT * FROM sales")
    
    phi = {'s': ['cust', 'prod', 'month', '1_sum_quant', '2_max_quant', '3_count_quant'], 'n': 3, 'v': ['cust', 'prod', 'month'], 'f': ['1_sum_quant', '2_max_quant', '3_count_quant', '2_sum_quant', '1_avg_quant', '3_avg_quant'], 'sigma': ["1.state = 'NY' and 1.quant > 20", "2.state = 'NJ'", "3.state = 'CT' and 3.quant >= 45"], 'g': '1_sum_quant > 2 * 2_sum_quant or 1_avg_quant > 3_avg_quant'}

    # convert phi from list to dictionary with keys as gv for simpler condition checking
    if 'sigma' in phi.keys():
        original_sigma_list = phi['sigma']
        phi['sigma'] = defaultdict(list)

        for cond in original_sigma_list:
            gv, expr = cond.split('.', 1)
            # Remove all gv prefixes like "1."  "cust", "quant"
            expr = re.sub(r'(?<!\w)(\d+)\.', '', expr)

            # Normalize single '=' to '==', but don't change >=, <=, !=, ==
            expr = re.sub(r'(?<![<>=!])=(?![=])', '==', expr)

            # Lowercase all standalone ANDs
            expr = re.sub(r'AND', 'and', expr, flags=re.IGNORECASE)

            # Append cleaned expression
            phi['sigma'][gv].append(expr.strip())

    MF_Struct = []
    
    
    for row in cur:
        # create a tuple of current row's grouping attribute values
        grouping_key = tuple(row[attr] for attr in phi['v'])

        # search MF_Struct to see if grouping_key already exists
        search_index = lookup(MF_Struct, phi['v'], grouping_key)

        # if it does not exist, create an entry in MF_Struct list
        if search_index == -1:
          
            new_entry = createMFStructEntry(phi, row)
            MF_Struct.append(new_entry)

        # if it already exists, update aggregates based on attribute values
        else:
            for s in phi['f']:
                parts = s.split('_')

                if len(parts) == 3:
                    gv, agg, attr = parts
                elif len(parts) == 2:
                    gv = ''
                    agg, attr = parts
                else:
                    raise ValueError(f"Unexpected aggregate format: {s}")
                
                if gv in phi.get('sigma', {}):
                    conditions = phi['sigma'][gv]
                    if not all(eval(cond, {}, row) for cond in conditions):
                        continue  # Skip update if condition not met
        
                if agg == 'count':
                    MF_Struct[search_index][s] += 1

                elif agg == 'sum':
                    MF_Struct[search_index][s] += row[attr]

                elif agg == 'min':
                    MF_Struct[search_index][s] = min(MF_Struct[search_index][s], row[attr])

                elif agg == 'max':
                    MF_Struct[search_index][s] = max(MF_Struct[search_index][s], row[attr])

                elif agg == 'avg':

                    sum_key = f"{gv}_sum_{attr}" if gv else f"sum_{attr}"
                    count_key = f"{gv}_count_{attr}" if gv else f"count_{attr}"

                    if sum_key not in phi['f']:
                        MF_Struct[search_index][sum_key] += row[attr]
                    if count_key not in phi['f']:
                        MF_Struct[search_index][count_key] += 1

                    MF_Struct[search_index][s] = MF_Struct[search_index][sum_key] / MF_Struct[search_index][count_key]

                else:
                    MF_Struct[search_index] = None
    
    #Filter MF_Struct by HAVING clause
    MF_Struct = [entry for entry in MF_Struct if entry['1_sum_quant'] > 2 * entry['2_sum_quant'] or entry['1_avg_quant'] > entry['3_avg_quant']]
    
    #remove any attributes used for calculation and not in select clause
    for entry in MF_Struct:
        for key in list(entry.keys()):
            if key not in phi['s']:
                del entry[key]
    
    
    
    return tabulate.tabulate(MF_Struct,
                        headers="keys", tablefmt="psql")

def main():
    print(query())
    
if "__main__" == __name__:
    main()
    